import{a1 as a,aG as s,a5 as t,a2 as e,f as n,aH as i,r as o,aV as u,w as l,aK as r,a as c,ab as d,ay as h,aP as g,a7 as m,a9 as p}from"./index-CioBjTVG.js";const[f,v,x]=a("pull-refresh"),T=["pulling","loosing","success"];const D=p(e({name:f,props:{disabled:Boolean,modelValue:Boolean,headHeight:s(50),successText:String,pullingText:String,loosingText:String,loadingText:String,pullDistance:t,successDuration:s(500),animationDuration:s(300)},emits:["change","refresh","update:modelValue"],setup(a,{emit:s,slots:t}){let e;const p=n(),f=n(),D=i(p),H=o({status:"normal",distance:0,duration:0}),V=u(),S=()=>{if(50!==a.headHeight)return{height:`${a.headHeight}px`}},$=()=>"loading"!==H.status&&"success"!==H.status&&!a.disabled,b=(t,e)=>{const n=+(a.pullDistance||a.headHeight);H.distance=t,H.status=e?"loading":0===t?"normal":t<n?"pulling":"loosing",s("change",{status:H.status,distance:t})},y=()=>{const{status:s}=H;return"normal"===s?"":a[`${s}Text`]||x(s)},P=()=>{const{status:a,distance:s}=H;if(t[a])return t[a]({distance:s});const e=[];return T.includes(a)&&e.push(c("div",{class:v("text")},[y()])),"loading"===a&&e.push(c(d,{class:v("loading")},{default:y})),e},B=a=>{e=0===g(D.value),e&&(H.duration=0,V.start(a))},Y=a=>{$()&&B(a)},j=()=>{e&&V.deltaY.value&&$()&&(H.duration=+a.animationDuration,"loosing"===H.status?(b(+a.headHeight,!0),s("update:modelValue",!0),h((()=>s("refresh")))):b(0))};return l((()=>a.modelValue),(s=>{H.duration=+a.animationDuration,s?b(+a.headHeight,!0):t.success||a.successText?(H.status="success",setTimeout((()=>{b(0)}),+a.successDuration)):b(0,!1)})),r("touchmove",(s=>{if($()){e||B(s);const{deltaY:t}=V;V.move(s),e&&t.value>=0&&V.isVertical()&&(m(s),b((s=>{const t=+(a.pullDistance||a.headHeight);return s>t&&(s=s<2*t?t+(s-t)/2:1.5*t+(s-2*t)/4),Math.round(s)})(t.value)))}}),{target:f}),()=>{var a;const s={transitionDuration:`${H.duration}ms`,transform:H.distance?`translate3d(0,${H.distance}px, 0)`:""};return c("div",{ref:p,class:v()},[c("div",{ref:f,class:v("track"),style:s,onTouchstartPassive:Y,onTouchend:j,onTouchcancel:j},[c("div",{class:v("head"),style:S()},[P()]),null==(a=t.default)?void 0:a.call(t)])])}}}));export{D as P};
