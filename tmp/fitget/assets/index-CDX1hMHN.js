import{q as e,t as a,x as o,u as l,f as i,r as s,U as t,y as r,w as n,o as m,c as u,a as d,m as p,z as c,l as g,A as v,F as f,B as y,p as h,b as x,C as b}from"./index-CioBjTVG.js";/* empty css              *//* empty css              *//* empty css              */import{L as w}from"./heade-hbqPw8HP.js";import{_}from"./chooseCountry.vue_vue_type_style_index_0_lang-Ll9qT5AW.js";import{A as j,B as T}from"./bizType-DS6j0Y_R.js";import{_ as V}from"./index-p6Lr4oSA.js";import{v as k,a as C,b as M}from"./validators-DCIwloLt.js";import{T as P,a as q}from"./index-Onjf-qgk.js";/* empty css                                                              */import"./headItem-Cz9qCjk4.js";import"./index-h3qOpuro.js";import"./index-C9iF-GfQ.js";import"./use-id-CcbAo3SX.js";/* empty css                                              */import"./index-CaK62ptd.js";import"./use-tab-status-_iNRjcO8.js";import"./index-DcdjDLdy.js";import"./index-Bde3MoM6.js";const F={key:0,class:"login-wrapper"},B={__name:"index",setup(B){const N=e(),I=a(),L=o(),{t:U}=l(),z=i({height:" 24px",lineHeight:"24px",fontSize:"16px",fontWeight:500,padding:"0 0 6px 0",marginRight:"24px"}),G=i("email"),O=i(),S=i(""),A=i(!1),D=i(!0),$=i(null),E=s({bizType:T.LOGIN,email:"",ga:"",phone:"",verifyEmail:!1,verifyGa:!1,verifyPhone:!1}),R=i([{tabTitle:U("邮箱登录"),name:"email",children:[{componentType:"input",type:"text",key:"email",placeholder:U("请输入邮箱"),rules:[{required:!0,message:U("请输入邮箱")},{validator:k,trigger:["onBlur"]}]},{componentType:"password",type:"password",key:"password",placeholder:U("请输入密码"),rules:[{required:!0,message:U("请填写密码")},{validator:C,trigger:["onBlur"]}]}]},{tabTitle:U("手机登录"),name:"mobile",children:[{componentType:"input",type:"text",key:"mobile",areaCode:S,leftIcon:"left-icon",placeholder:U("请输入手机号"),onChooseCountry:()=>{A.value=!0},rules:[{required:!0,message:U("请输入手机号")},{validator:M,trigger:["onBlur"]}]},{componentType:"password",type:"password",key:"password",placeholder:U("请输入密码"),rules:[{required:!0,message:U("请输入密码")},{validator:C,trigger:["onBlur"]}]}]}]),W=()=>{I.push({name:"register"})},H=e=>{switch(Z.formModelValues[e.name]=null,D.value=!0,e.name){case"email":Z.formModelValues.mobile=null,delete Z.formModelValues.mobile;break;case"mobile":Z.formModelValues.email=null,delete Z.formModelValues.email}},J=()=>{let e=localStorage.getItem(v);e=JSON.parse(e),N.login=!0,N.setUserInfo(e),I.push({name:"home"})},X=async({fullAccount:e,result:a})=>{const o=$.value;a.areaCode=o.areaCode,a.loginPwd=o.loginPwd;let l=!1;try{console.log("twice login",e),l=await t.twiceLogin(e,a)}catch(i){console.error("twice login error",i)}l&&J()},Y=()=>{const{mobile:e,email:a,password:o}=Z.formModelValues,l=e?"phone":"email",i="phone"===l?e:a;console.log("login account",i),$.value={account:i,accountType:l,areaCode:S.value,loginPwd:o,bizType:T.LOGIN,ext:{...E}},console.log("twiceParams",$)},Z=s({formModelValues:{},submitText:U("登录"),submitDisabled:D,onSubmit:async({mobile:e,email:a,password:o})=>{const l=await t.login({loginName:e?`${S.value}-${e}`:a,loginPwd:o});if(1==l)J();else if(!isNaN(l))switch(l){case 1079:E.verifyGa=!0;case 1076:return void Y();case 1078:E.verifyGa=!0,Y();break;case 1088:E.verifyEmail=!0}},formConfigList:[]}),K=e=>{O.value=e.icon,S.value=e.countryCode},Q=()=>{I.push({name:"forgetPwd",query:{resetType:G.value,areaCode:S.value}})};return r((()=>{G.value=L.query.active,console.log("route====",L.query)})),n((()=>Z.formModelValues),(e=>{console.log("newFormData",e),(e=>{switch(G.value){case"email":D.value=!(e.email&&e.password);break;case"mobile":D.value=!(e.mobile&&e.password)}})(e)}),{immediate:!0,deep:!0}),(e,a)=>{const o=q,l=P;return $.value?(m(),g(j,{key:1,twiceParams:$.value,onNext:X,onBack:a[3]||(a[3]=e=>$.value=null)},null,8,["twiceParams"])):(m(),u("div",F,[d(w,{leftText:p(U)("登录"),rightText:p(U)("注册"),onOnClick:W},null,8,["leftText","rightText"]),d(l,{active:G.value,"onUpdate:active":a[1]||(a[1]=e=>G.value=e),shrink:"","title-inactive-color":"#FFFFFF","title-active-color":"var(--basic---)",background:"var(--Misc-body-bg)",color:"var(--basic---)","line-width":"64px","line-height":"2px",onClickTab:H},{default:c((()=>[(m(!0),u(f,null,y(R.value,(e=>(m(),g(o,{title:e.tabTitle,name:e.name,key:e.name,"title-style":z.value},{default:c((()=>[d(V,h({modelValue:Z.formModelValues,"onUpdate:modelValue":a[0]||(a[0]=e=>Z.formModelValues=e),ref_for:!0},{...Z,formConfigList:e.children}),null,16,["modelValue"]),x("p",{class:"forget-pwd-btn",onClick:Q},b(p(U)("忘记密码"))+"？",1)])),_:2},1032,["title","name","title-style"])))),128))])),_:1},8,["active"]),d(_,{modelValue:A.value,"onUpdate:modelValue":a[2]||(a[2]=e=>A.value=e),onChoose:K},null,8,["modelValue"])]))}}};export{B as default};
