const __vite__fileDeps=["assets/switchGoogle-BXuamhbr.js","assets/securityAuthorityTip-jGWCK-y_.js","assets/index-CioBjTVG.js","assets/index-BWk-JvvK.css","assets/securityAuthorityTip-CtfJNRa0.css","assets/switchAuthority-BdnQxnqg.js","assets/switchAuthority-DgQdsq9R.css","assets/icon_img_security-DnL5Ur2x.js","assets/downGoogle-H9CqClZ9.js","assets/secureItem-i-1JMjvJ.js","assets/secureItem-BfgHS5N6.css","assets/nextStepButton-DivKrDJE.js","assets/index-h3qOpuro.js","assets/index-C0aVTKij.css","assets/nextStepButton-DDKiqL--.css","assets/copySecretKey-BXm1UJlG.js","assets/pasteSecretKey-BXt6pyOL.js","assets/index-p6Lr4oSA.js","assets/index-C9iF-GfQ.js","assets/use-id-CcbAo3SX.js","assets/index-CyX4aIak.css","assets/index-CaK62ptd.js","assets/index-B_WVPCqv.css","assets/pasteSecretKey-Cy0N9uiI.css","assets/secretKeyExample-BN7xcqG-.js","assets/index-DcdjDLdy.js","assets/secretKeyExample-CjQYt-Nj.css","assets/index-B3ybuspM.css"],__vite__mapDeps=i=>i.map(i=>__vite__fileDeps[i]);
import{u as e,r as o,f as a,h as s,j as l,k as t,s as i,w as n,o as u,c as r,l as m,m as p,n as d,b as c,a as y,p as g,_ as v,t as _,x as f,q as h,U as b,aU as w,bs as x,am as I}from"./index-CioBjTVG.js";import{_ as C}from"./headItem-Cz9qCjk4.js";import{u as T}from"./index-BftDkDiY.js";import{u as j}from"./useCountDown-CQ69-YoB.js";import{_ as k}from"./index-p6Lr4oSA.js";import{M as V}from"./MsgService-B2ZXYJt1.js";import{_ as D}from"./index-Csiaqh1k.js";import"./index-h3qOpuro.js";import"./index-C9iF-GfQ.js";import"./use-id-CcbAo3SX.js";/* empty css                                              */import"./index-CaK62ptd.js";/* empty css                                              */const S={class:"authority-wrapper"},E={class:"authority-content"},O={class:"mobile-authority-wrapper"},L={__name:"index",props:{security:{type:Object,require:!0},userInfo:{type:Object,require:!0},bizType:{type:String,require:!0},showTitle:{type:Boolean,require:!1}},emits:["next"],setup(v,{emit:_}){const f=_,h=v,{t:b}=e(),w=o({}),x=a(!0),I=s((()=>h.bizType)),T=/^\d{6}$/,D=o({formModelValues:{},submitText:b("提交"),submitDisabled:x,onSubmit:e=>{console.log(e),L(e)},formConfigList:[]});l((()=>{h.security.mobile&&D.formConfigList.push({componentType:"sms",type:"text",key:"sms",label:`${b("将发送验证码到")}${h.userInfo.mobile}`,labelAlign:"top",placeholder:b("请输入验证码"),isImmediate:!1,countDownData:j(),handlerCountdown:(e,o)=>{(async e=>{const o=await V.sendVerifyCode({bizType:I.value,type:"phone"});w.mobile=o,console.log(w),e()})(e)},maxlength:6,rules:[{pattern:T,message:b("请输入6位数字验证码")}]}),h.security.email&&D.formConfigList.push({componentType:"sms",type:"text",key:"emailCode",label:`${b("将发送验证码到")}${h.userInfo.email}`,labelAlign:"top",placeholder:b("请输入验证码"),countDownData:j(),isImmediate:!1,handlerCountdown:(e,o)=>{(async e=>{const o=await V.sendVerifyCode({bizType:I.value,type:"email"});w.email=o,console.log(w),e()})(e)},maxlength:6,rules:[{pattern:T,message:b("请输入6位数字验证码")}]}),D.formConfigList.push({componentType:"input",type:"text",key:"googleSms",label:b("输入Google验证码"),labelAlign:"top",rightText:b("粘贴"),clickRightText:async e=>{const o=await t();console.log("key",o),D.formModelValues.googleSms=o},placeholder:b("请输入验证码"),rules:[{required:!0,message:b("请输入验证码")}]})}));const L=async({sms:e,emailCode:o,googleSms:a})=>{const s=w.mobile,l=w.email;return h.security.mobile&&!s||h.security.email&&!l?(i(b("请先发送验证码")),!1):void f("next",{bizType:I.value,googleCode:a,verifyCode:e,verifyCodeId:s,emailVerifyCode:o,emailVerifyCodeId:l})};return n((()=>D.formModelValues),(e=>{console.log("newFormData",e),(e=>{x.value=!e.sms})(e)}),{immediate:!0,deep:!0}),(e,o)=>{const a=C;return u(),r("div",S,[v.showTitle?(u(),m(a,{key:0,headTt:p(b)("安全认证")},null,8,["headTt"])):d("",!0),c("div",E,[c("div",O,[y(k,g({modelValue:D.formModelValues,"onUpdate:modelValue":o[0]||(o[0]=e=>D.formModelValues=e)},D),null,16,["modelValue"])])])])}}},A={class:"google-anth-wrapper"},M={key:0,class:"google-secure-wrapper"},q=v({__name:"index",setup(o){const t=w((()=>I((()=>import("./switchGoogle-BXuamhbr.js")),__vite__mapDeps([0,1,2,3,4,5,6,7])))),n=w((()=>I((()=>import("./downGoogle-H9CqClZ9.js")),__vite__mapDeps([8,1,2,3,4,9,10,11,12,13,14,7])))),c=w((()=>I((()=>import("./copySecretKey-BXm1UJlG.js")),__vite__mapDeps([15,1,2,3,4,9,10,11,12,13,14,7])))),g=w((()=>I((()=>import("./pasteSecretKey-BXt6pyOL.js")),__vite__mapDeps([16,17,2,3,12,13,18,19,20,21,22,23])))),v=w((()=>I((()=>import("./secretKeyExample-BN7xcqG-.js")),__vite__mapDeps([24,2,3,11,12,13,14,25,26,27])))),{toClipboard:j}=T(),k=_(),V=f(),{t:S}=e(),E=h(),O=s((()=>E.userInfo)),q=s((()=>null==E.userInfo?null:E.userInfo.security)),z=a(S("谷歌验证器"));s((()=>V.query));const R=a(!0),U=a(!1),$=a(!1),G=a(!1),P=a(),B=a(!1),K=a(!1),N=a(!1),F=a(!1),H=()=>{k.push({name:"userCenterSecure"})},J=e=>{U.value=e,e?(R.value=!1,$.value=!0):(R.value=!1,F.value=!0)},Q=()=>{x().isIOS?window.open("https://itunes.apple.com/us/app/google-authenticator/id388497605?mt=8"):window.open("https://play.google.com/store/apps/details?id=com.google.android.apps.authenticator2")},W=()=>{$.value=!1,G.value=!0,console.log("downNextStep")},X=async e=>{$.value=!1,G.value=!0;try{await j(e),i(S("已复制到粘贴板"))}catch(o){console.error(o)}},Y=e=>{G.value=!1,B.value=!0,P.value=e,z.value=S("输入16位密钥")},Z=()=>{B.value=!1,K.value=!0},ee=()=>{K.value=!1,N.value=!0,z.value=S("安全认证")},oe=async e=>{await b.bindGoogle({...e,...P.value}),N.value=!1,R.value=!0,b.getUserInfo()},ae=async e=>{await b.unbindGoogle(e),F.value=!1,R.value=!0,b.getUserInfo()};return l((async()=>{b.getUserInfo()})),(e,o)=>{const a=C;return u(),r("div",A,[y(a,{headTt:z.value,goBack:H},null,8,["headTt"]),null!=O.value?(u(),r("div",M,[R.value?(u(),m(p(t),{key:0,onOnSwitch:J,isSwitchOn:q.value.googleCode},null,8,["isSwitchOn"])):d("",!0),$.value?(u(),m(p(n),{key:1,onClick:W,onDown:Q})):d("",!0),G.value?(u(),m(p(c),{key:2,onClick:Y,onCopy:X})):d("",!0),B.value?(u(),m(p(g),{key:3,googleInfo:P.value,onClick:Z},null,8,["googleInfo"])):d("",!0),K.value?(u(),m(p(v),{key:4,onClick:ee})):d("",!0),N.value?(u(),m(L,{key:5,bizType:"bind-google",security:q.value,userInfo:O.value,onNext:oe},null,8,["security","userInfo"])):d("",!0),F.value?(u(),m(D,{key:6,bizType:"unbind-google",security:q.value,userInfo:O.value,onNext:ae},null,8,["security","userInfo"])):d("",!0)])):d("",!0)])}}},[["__scopeId","data-v-f36e82da"]]);export{q as default};
