import{a1 as e,aG as a,au as i,a6 as o,a2 as r,f as s,aH as t,h as n,w as l,aW as d,j as u,a4 as c,aK as f,a as g,ay as h,aM as p,aL as v,ab as m,a9 as b}from"./index-ZSwLI674.js";import{u as x}from"./use-tab-status-yiZOeCkD.js";const[T,j,k]=e("list");const B=b(r({name:T,props:{error:Boolean,offset:a(300),loading:Boolean,disabled:Boolean,finished:Boolean,scroller:Object,errorText:String,direction:i("down"),loadingText:String,finishedText:String,immediateCheck:o},emits:["load","update:error","update:loading"],setup(e,{emit:a,slots:i}){const o=s(e.loading),r=s(),b=s(),T=x(),B=t(r),w=n((()=>e.scroller||B.value)),C=()=>{h((()=>{if(o.value||e.finished||e.disabled||e.error||!1===(null==T?void 0:T.value))return;const{direction:i}=e,s=+e.offset,t=p(w);if(!t.height||v(r))return;let n=!1;const l=p(b);n="up"===i?t.top-l.top<=s:l.bottom-t.bottom<=s,n&&(o.value=!0,a("update:loading",!0),a("load"))}))},S=()=>{if(e.finished){const a=i.finished?i.finished():e.finishedText;if(a)return g("div",{class:j("finished-text")},[a])}},y=()=>{a("update:error",!1),C()},L=()=>{if(e.error){const a=i.error?i.error():e.errorText;if(a)return g("div",{role:"button",class:j("error-text"),tabindex:0,onClick:y},[a])}},G=()=>{if(o.value&&!e.finished&&!e.disabled)return g("div",{class:j("loading")},[i.loading?i.loading():g(m,{class:j("loading-icon")},{default:()=>[e.loadingText||k("loading")]})])};return l((()=>[e.loading,e.finished,e.error]),C),T&&l(T,(e=>{e&&C()})),d((()=>{o.value=e.loading})),u((()=>{e.immediateCheck&&C()})),c({check:C}),f("scroll",C,{target:w,passive:!0}),()=>{var a;const s=null==(a=i.default)?void 0:a.call(i),t=g("div",{ref:b,class:j("placeholder")},null);return g("div",{ref:r,role:"feed",class:j(),"aria-busy":o.value},["down"===e.direction?s:t,G(),S(),L(),"up"===e.direction?s:t])}}}));export{B as L};
